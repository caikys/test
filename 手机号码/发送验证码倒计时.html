<!DOCTYPE html>
<!-- 登陆 -->
<html>

<head>
<meta charset="UTF-8">
<title>登录</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<link rel="stylesheet" href="../js/mui/css/mui.css">
<link rel="stylesheet" href="../css/iconfont/iconfont.css">
<script type="text/javascript" src="../css/iconfont/iconfont.js"></script>
<script src="../js/mui/js/mui.js"></script>
<script src="../js/flexible.js"></script>
<script src="../js/jquery-1.12.0.js"></script>
<style>
	  *{
	  	margin: 0px;
	  	padding: 0px;
	  }
	  html,body{
	  	width: 100%;
	  	height: 100%;
	  }
	  #slider{
	      position: relative;
	      top: 1.2rem;
	      background-size: cover;
	      background-position: center center;
	      background-repeat: no-repeat;
	      width: 100%;
	      overflow-x: hidden;
	      min-height: calc(100% - 1.2rem);
	      background-color: white;
	  } 
	  a{
	  	text-decoration: none;
	  }
	  li{
	  	list-style: none;
	  }
	  #slider > .login_type{
	  	display: block;
	  	width: 5.546667rem;
	  	margin: 0 auto;
	  	font-size: 0.373333rem;
	  	font-weight: 600;
	  	padding-top: 0.64rem;
	  }
	  #slider > .login_type > span{
	  	 display: inline-block;
	  	 width: 2.266667rem;
	  	 padding-bottom: 0.133333rem;
	  	 border-bottom: 0.053333rem solid transparent;
	  	 text-align: center;
	  	 color:#777777;
	  }
	  .login_type_click{
	  	border-color: #333333 !important;
	  	color:#333333 !important;
	  }
	  #slider > .login_type > span:nth-child(1){
	  	 margin-right: 1.013333rem;
	  }
	  .register_mdoal{
	  	display: block;
	  	padding-top: 0.426667rem;
	  	width: 9.066667rem;
	  	margin: 0 auto;
	  	overflow: hidden;
	  }
	  .register_mdoal > ul{
	  	 width: 200%;
	  	 transition: all 0.5s;
	  }
	  .register_mdoal > ul > li{
	  	width: 50%;
	  	display: block;
	  	float: left;
	  }
	  .register_mdoal > ul > li > a{
	  	float: right;
	  	color:#777777;
	  	font-size: 0.32rem;
	  	padding-top: 0.4rem;
	  }
	  .register_mdoal > ul > li>  p {
	  	color: #F8323F;
	  	font-size: 0.266667rem;
	  	margin-bottom: 0.106667rem;
	  	text-align: left;
	  	visibility: hidden;
	  }
	  .register_mdoal > ul > li >div{
	  	width: 100%;
	    height: 1.2rem;
        border: 2px solid #EBEBEB;
	  }
	  .color_div{
	  	border-color: #333333 !important;
	  }
	  .register_mdoal > ul > li > div > i:nth-child(1){
	  	display: block;
	  	width: 1.333333rem;
	  	height: 1.1rem;
	  	font-size:0.666667rem ;
	  	line-height: 1.173333rem;
	  	float: left;
	  	text-align: center;
	  	font-weight: 600;
	  }
	  .right-icon,.right-icon1{
	  	 position: relative;
         z-index: 100;
         color: grey !important;
         width: 0.96rem;
         height: 1.173333rem;
         text-align: center;
         line-height: 1.173333rem;
         float: right;
         display: none;
	  }
	  .right-icon1{
	  	display: block;
	  }
	  .register_mdoal > ul > li > div > input{
	  	position: absolute;
	  	border: 0px solid;
	  	margin: 0px;
	  	padding: 0px;
	  	width: 5.546667rem; 
	  	height: 1.07rem;
	  }
	  .register_click{
	  	display: block;
	  	height: 1.173333rem !important;
	  	background-color: #333333;
	  	line-height: 1.173333rem;
	  	color: white;
	  	text-align: center;
	  	font-size: 0.373333rem;
	  	margin-top: 1.146667rem;
	  }

	  .yanzhengma{
	  	display: block;
	  	position: relative;
	  	width: 2.133333rem;
	  	height: 1.173333rem;
	  	line-height: 1.173333rem;
	  	text-align: center;
	  	float: right;
	  	font-size: 0.32rem;
	  	padding: 0px;
	  	border: 0px;
	  	background-color: transparent;
	  }
</style>

</head>

<body>
   <div id="slider">
        <div class="login_type"><span class="login_type_click">短信登录</span><span>账号登录</span></div>
       <div class="register_mdoal">
          <ul>
           <li>
           <p class="phone_error">*请输入正确手机号码</p>
            <div><i class="iconfont icon-shouji"></i><input type="text" placeholder="输入手机号码" class="phone_num"><i class="iconfont icon-qingchu right-icon"></i></div>
            <p class="phone_error">*请输入正确验证码</p>
            <div><i class="iconfont icon-duanxin"></i><input type="text" placeholder="输入短信验证码" class="passw"><button class="yanzhengma">发送验证码</button></div>
            <span class="register_click">立即登录</span>
           </li>
          <li>
            <p class="phone_error">*请输入正确手机号码</p>
            <div><i class="iconfont icon-shouji"></i><input type="text" placeholder="输入账号" class="phone_num1"><i class="iconfont icon-qingchu right-icon"></i></div>
            <p class="phone_error">*请输入正确密码</p>
            <div><i class="iconfont icon-mima"></i><input type="password" placeholder="输入6~12位密码" class="passw1"><i class="iconfont icon-yan right-icon1"></i></div>
            <span class="register_click">立即登录</span>
            <a href="{:__URL('APP_MAIN/Login/forget.html')}">忘记密码?</a>
           </li>
          
           <ul>
       </div>
   </div>
</body>
<script type="text/javascript">
     mui.init();
     var counttime = 60;
     var timeitv;
     mui('body').on('tap', '.register_mdoal > ul > li > a', function() {
     	window.top.location.href = this.href;
     });
     $('.login_type > span').click(function() {
     	$(this).addClass('login_type_click');
     	$(this).siblings().removeClass('login_type_click');
     	if ($('.login_type > span').eq(0).hasClass('login_type_click')) {
     		$('.register_mdoal > ul').css({
     			'transform': 'translateX(0)'
     		});
     	} else {
     		$('.register_mdoal > ul').css({
     			'transform': 'translateX(-50%)'
     		});
     	}
     })
     mui('body').on('tap', '.right-icon1', function() {
     	if ($(".right-icon1").hasClass('icon-yan')) {
     		$(".right-icon1").parent().find('input').attr("type", "text");
     		$(".right-icon1").removeClass('icon-yan').addClass('icon-biyan');
     	} else {
     		$(".right-icon1").parent().find('input').attr("type", "password");
     		$(".right-icon1").removeClass('icon-biyan').addClass('icon-yan');
     	}
     });
     mui('body').on('tap', '.yanzhengma', function() {
     	if (/^1[3|4|5|8][0-9]\d{4,8}$/.test($('.phone_num').val())) {
     		$.ajax({
     			type: "post",
     			url: "{:__URL('APP_MAIN/login/mobile')}",
     			data: {
     				"mobile": $('.register_mdoal > div > input').eq(0).val()
     			},
     			success: function(data) {
     				if (!data) {
     					$('.phone_error').eq(0).text("*手机号未注册");
     					$('.phone_error').eq(0).css({
     						"visibility": "visible"
     					});
     					return;
     				} else {
     					$.ajax({
     						type: "post",
     						url: "{:__URL('APP_MAIN/Login/sendSmsRegisterCode')}",
     						data: {
     							"mobile": $('.phone_num').val()
     						},
     						success: function(data) {
     							if (data.code == 0) {
     								$('.yanzhengma').attr("disabled", true);
     								timeitv = setInterval(tip, 1000);
     							}
     						}
     					})
     				}
     			}
     		})
     	} else {
     		$('.phone_error').eq(0).text("*请输入正确手机号");
     		$('.phone_error').eq(0).css({
     			"visibility": "visible"
     		});

     	}
     })
     $('.register_mdoal > ul >li >div > input').blur(function() {
     	$(this).parent().removeClass('color_div');
     })
     $('.register_mdoal > ul >li >div').click(function() {
     	$(this).addClass('color_div');
     	$(this).siblings().removeClass('color_div');
     })
     $('.phone_num , .phone_num1').bind('input prototypechange', function() {
     	if ($(this).val() != '') {
     		$(this).parent().find('.right-icon').css({
     			"display": "block"
     		});
     	} else {
     		$(this).parent().find('.right-icon').css({
     			"display": "none"
     		});
     	}
     });
     $('.right-icon').click(function() {
     	$(this).parent().find('input').val('');
     	$(this).css({
     		"display": "none"
     	});
     });

     mui('body').on('tap', '.register_click', function() {
     	if ($('.login_type > span').eq(0).hasClass('login_type_click')) {
     		$.ajax({
     			type: "post",
     			url: "{:__URL('APP_MAIN/login/login')}",
     			data: {
     				"mobile": $('.phone_num').val(),
     				"sms_captcha": $(".passw").val()
     			},
     			success: function(data) {
     				if (data.code > 0) {
     					if (data.code == 1) {
     						window.location.href = data['url'];
     					} else {
     						window.location.href = data['url'];
     					}
     				} else {
     					$('.register_mdoal > ul> li').eq(0).find('.phone_error').eq(1).css({
     						"visibility": "visible"
     					});
     					$('.register_mdoal > ul> li').eq(0).find('.phone_error').eq(0).css({
     						"visibility": "hidden"
     					});
     				}
     			}
     		})

     	} else {
     		if ($('.phone_num1').val() != '') {
     			if ($('.passw1').val() != '' && parseInt($('.passw1').val().length) > 5) {
     				login($('.phone_num1').val(), $('.passw1').val());
     			} else {
     				$('.register_mdoal > ul> li').eq(1).find('.phone_error').eq(1).text("*请输入正确密码");
     				$('.register_mdoal > ul> li').eq(1).find('.phone_error').eq(1).css({
     					"visibility": "visible"
     				});
     				$('.register_mdoal > ul> li').eq(1).find('.phone_error').eq(0).css({
     					"visibility": "hidden"
     				});
     			}
     		} else {
     			$('.register_mdoal > ul> li').eq(1).find('.phone_error').eq(0).css({
     				"visibility": "visible"
     			});
     			$('.register_mdoal > ul> li').eq(1).find('.phone_error').eq(1).css({
     				"visibility": "hidden"
     			});
     		}
     	}
     })
     function tip() {
     	counttime--;
     	if (counttime < 1) {
     		$(".yanzhengma").removeAttr("disabled");
     		counttime = 60;
     		var t2 = clearInterval(timeitv);
     		$(".yanzhengma").text("发送验证码")
     	} else {
     		$(".yanzhengma").text(counttime);
     	}

     }


     function login(username, password) {
     	$.ajax({
     		type: "post",
     		url: "{:__URL('APP_MAIN/login/login')}",
     		async: true,
     		data: {
     			"username": username,
     			"password": password
     		},
     		success: function(data) {
     			if (data["code"] > 0) {
     				if (data["code"] == 1) {
     					window.location.href = data['url'];
     				} else {
     					window.location.href = data['url'];
     				}
     			} else {
     				console.log(data["message"]);
     				$('.register_mdoal > ul> li').eq(1).find('.phone_error').eq(1).text(data["message"]);
     				$('.register_mdoal > ul> li').eq(1).find('.phone_error').eq(1).css({
     					"visibility": "visible"
     				});
     				$('.register_mdoal > ul> li').eq(1).find('.phone_error').eq(0).css({
     					"visibility": "hidden"
     				});
     			}
     		}
     	});
     }
</script>
</html>